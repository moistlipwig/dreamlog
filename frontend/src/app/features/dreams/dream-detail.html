@if (dream$ | async; as dream) {
  <div class="detail-card max-w-4xl mx-auto">
    <!-- Hero Section -->
    <div class="detail-hero">
      <div class="hero-content">
        <div class="flex justify-between items-start mb-4">
          <div class="flex-1">
            <h1 class="text-4xl font-bold mb-2 text-white">{{ dream.title }}</h1>
            <p class="text-purple-100 text-lg">{{ dream.date | date: 'EEEE, dd MMMM yyyy' }}</p>
          </div>
          @if (dream.lucid) {
            <span class="lucid-badge">
              <span class="material-icons">auto_awesome</span>
              LUCID
            </span>
          }
        </div>
      </div>
    </div>

    <!-- Content Section -->
    <div class="detail-content">
      <!-- AI Generated Image Placeholder -->
      <div class="image-placeholder">
        <div class="text-center">
          <span class="material-icons placeholder-icon">image</span>
          <p class="mt-3 font-semibold text-lg">AI-Generated Dream Visualization</p>
          <p class="text-sm text-gray-500 mt-1">(Coming in Phase 8)</p>
        </div>
      </div>

      <!-- Dream Description -->
      <div class="section">
        <h3 class="section-title">
          <span class="material-icons">description</span>
          Dream Description
        </h3>
        <p class="dream-text">{{ dream.content }}</p>
      </div>

      <!-- Metadata Grid -->
      <div class="metadata-grid">
        @if (dream.moodInDream) {
          <div class="metadata-badge">
            <span class="metadata-label">Mood During</span>
            <span class="metadata-value">
              <span class="material-icons mood-icon">{{ getMoodIcon(dream.moodInDream) }}</span>
              {{ formatMood(dream.moodInDream) }}
            </span>
          </div>
        }

        @if (dream.moodAfterDream) {
          <div class="metadata-badge">
            <span class="metadata-label">Mood After</span>
            <span class="metadata-value">
              <span class="material-icons mood-icon">{{ getMoodIcon(dream.moodAfterDream) }}</span>
              {{ formatMood(dream.moodAfterDream) }}
            </span>
          </div>
        }

        <div class="metadata-badge">
          <span class="metadata-label">Vividness</span>
          <span class="metadata-value">
            <span class="material-icons vividness-icon">star</span>
            {{ dream.vividness }}/10
          </span>
        </div>

        <div class="metadata-badge">
          <span class="metadata-label">Type</span>
          <span class="metadata-value">
            <span class="material-icons type-icon">{{ dream.lucid ? 'auto_awesome' : 'bedtime' }}</span>
            {{ dream.lucid ? 'Lucid' : 'Regular' }}
          </span>
        </div>
      </div>

      <!-- AI Interpretation Placeholder -->
      <div class="interpretation-box">
        <h3 class="section-title">
          <span class="material-icons">psychology</span>
          AI Dream Interpretation
        </h3>
        <p class="text-gray-400 italic">
          AI interpretation will appear here after analysis (Phase 4)
        </p>
      </div>

      <!-- Tags -->
      @if (dream.tags && dream.tags.length > 0) {
        <div class="section">
          <h3 class="tags-label">Dream Tags</h3>
          <app-tag-chips [tags]="dream.tags"></app-tag-chips>
        </div>
      }

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button mat-button class="btn-secondary" routerLink="/app/dreams">
          Back to Dreams
        </button>
        <button mat-flat-button class="btn-primary" [routerLink]="['/app/dreams', dream.id, 'edit']">
          Edit Dream
        </button>
      </div>
    </div>
  </div>
} @else {
  <!-- Loading skeleton -->
  <div class="max-w-4xl mx-auto">
    <div class="detail-card animate-pulse">
      <div class="detail-hero">
        <div class="h-10 bg-purple-400/20 rounded w-2/3 mb-3"></div>
        <div class="h-6 bg-purple-300/20 rounded w-1/3"></div>
      </div>
      <div class="detail-content space-y-6">
        <div class="h-64 bg-gray-700 rounded"></div>
        <div class="h-32 bg-gray-800 rounded"></div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div class="h-20 bg-gray-700 rounded"></div>
          <div class="h-20 bg-gray-700 rounded"></div>
          <div class="h-20 bg-gray-700 rounded"></div>
          <div class="h-20 bg-gray-700 rounded"></div>
        </div>
      </div>
    </div>
  </div>
}
