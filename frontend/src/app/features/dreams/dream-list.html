<div class="dream-list-container">
  <!-- Header Toolbar: Title | Search in one line -->
  <div class="dream-list-header">
    <h1>Dreamlog</h1>
    <div class="header-search">
      <app-search-bar></app-search-bar>
    </div>
  </div>

  <!-- Dreams Grid -->
  @if (vm$ | async; as vm) {
    @if (vm.loading) {
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        @for (_ of skeletons; track $index) {
          <mat-card class="dream-card p-6 animate-pulse space-y-3">
            <div class="h-5 bg-gray-700 rounded w-2/3"></div>
            <div class="h-4 bg-gray-700 rounded w-1/3"></div>
            <div class="h-20 bg-gray-800 rounded mt-4"></div>
            <div class="h-2 bg-gray-700 rounded w-full"></div>
          </mat-card>
        }
      </div>
    } @else if (vm.results.length) {
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        @for (dream of vm.results; track dream.id) {
          <mat-card
            class="dream-card cursor-pointer"
            [class]="getMoodClass(dream.moodInDream)"
            [routerLink]="['/app/dreams', dream.id]"
          >
            <mat-card-header class="pb-0">
              <div class="flex justify-between items-start w-full">
                <div class="flex-1">
                  <mat-card-title class="text-xl font-semibold text-white mb-1">
                    {{ dream.title }}
                  </mat-card-title>
                  <mat-card-subtitle class="text-sm text-gray-400">
                    {{ dream.date | date: 'dd MMM yyyy' }}
                  </mat-card-subtitle>
                </div>
                @if (dream.lucid) {
                  <span class="lucid-badge">
                    <span class="material-icons">auto_awesome</span>
                    LUCID
                  </span>
                }
              </div>
            </mat-card-header>

            <mat-card-content class="pt-3">
              <p class="text-sm text-gray-300 mb-3 line-clamp-2 leading-relaxed">
                {{ dream.content }}
              </p>

              <div class="flex items-center gap-2 mb-3">
                <span class="text-xs text-gray-500">Vividness</span>
                <div class="flex-1 vividness-track">
                  <div class="vividness-indicator" [style.width.%]="dream.vividness * 10"></div>
                </div>
                <span class="text-xs font-semibold text-purple-300">{{ dream.vividness }}/10</span>
              </div>

              <app-tag-chips [tags]="dream.tags"></app-tag-chips>
            </mat-card-content>
          </mat-card>
        }
      </div>
    } @else {
      <app-empty-state message="No dreams found"></app-empty-state>
    }
  }

  <a mat-fab routerLink="/app/dreams/new" aria-label="Add new dream" class="fab-add-dream">
    <mat-icon>add</mat-icon>
  </a>
</div>
