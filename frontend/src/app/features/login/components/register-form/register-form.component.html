<form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form" autocomplete="off">
  @if (errorMessage()) {
    <div class="error-message bg-red-50 text-red-800 p-3 rounded-md mb-4" role="alert">
      {{ errorMessage() }}
    </div>
  }

  <mat-form-field appearance="outline" class="w-full">
    <input
      matInput
      formControlName="email"
      type="email"
      placeholder="your@email.com"
      autocomplete="email"
      autocapitalize="off"
      spellcheck="false"
      inputmode="email"
      (blur)="onFieldBlur('email')"
      [attr.aria-invalid]="registerForm.get('email')?.invalid && shouldShowError('email')"
    />
    @if (registerForm.get('email')?.invalid && shouldShowError('email')) {
      @if (registerForm.get('email')?.hasError('required')) {
        <mat-error>⚠️ Email is required</mat-error>
      }
      @if (registerForm.get('email')?.hasError('email')) {
        <mat-error>⚠️ Please enter a valid email</mat-error>
      }
    }
  </mat-form-field>

  <mat-form-field appearance="outline" class="w-full">
    <input matInput formControlName="name" type="text" placeholder="Your name" autocomplete="name"/>
  </mat-form-field>

  <mat-form-field appearance="outline" class="w-full">
    <input
      matInput
      formControlName="password"
      type="password"
      placeholder="Create a password"
      autocomplete="new-password"
      autocapitalize="off"
      spellcheck="false"
      (blur)="onFieldBlur('password')"
      [attr.aria-invalid]="registerForm.get('password')?.invalid && shouldShowError('password')"
    />
    @if (registerForm.get('password')?.invalid && shouldShowError('password')) {
      @if (registerForm.get('password')?.hasError('required')) {
        <mat-error>⚠️ Password is required</mat-error>
      }
      @if (registerForm.get('password')?.hasError('minlength')) {
        <mat-error>⚠️ Password must be at least 8 characters</mat-error>
      }
      @if (registerForm.get('password')?.hasError('passwordPolicy')) {
        <mat-error>⚠️ Password must contain letters and numbers</mat-error>
      }
    }
    <mat-hint>Min 8 characters, letters + numbers</mat-hint>
  </mat-form-field>

  <button mat-flat-button color="primary" type="submit" class="w-full" [disabled]="isLoading()">
    @if (isLoading()) {
      Creating account...
    } @else {
      Create Account
    }
  </button>
</form>
